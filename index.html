<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Happy 17th Birthday</title>
  <style>
    html,body{margin:0;height:100%;background:#05060a;overflow:hidden}
    canvas{display:block;width:100vw;height:100vh}
    .ui{
      position:fixed; left:50%; bottom:16px; transform:translateX(-50%);
      display:flex; gap:10px; align-items:center;
      font-family:system-ui, Arial; color:#e2e8f0; font-size:14px;
      padding:10px 12px; border-radius:999px;
      background:rgba(0,0,0,.35); border:1px solid rgba(255,255,255,.10);
      backdrop-filter: blur(8px);
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
      user-select:none;
    }
    .btn{
      cursor:pointer;
      padding:8px 12px; border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.06);
      color:#fff;
    }
    .btn:active{transform:scale(.98)}
    .tag{opacity:.85}
  </style>
</head>
<body>
<canvas id="c"></canvas>

<div class="ui">
  <button class="btn" id="replay">Replay ‚ú®</button>
  <span class="tag">Tap anywhere for extra fireworks üéÜ</span>
</div>

<script>
(() => {
  const canvas = document.getElementById("c");
  const ctx = canvas.getContext("2d", { alpha:false });

  // =========================
  //  ROOSH SEQUENCE (EDIT HERE)
  // =========================
  // ŸÉŸÑ ÿπŸÜÿµÿ±: ŸÜÿµ + ŸÖÿØÿ© ÿ∏ŸáŸàÿ±Ÿá ÿ®ÿßŸÑŸÖŸÑŸÑŸä ÿ´ÿßŸÜŸäÿ© + ŸáŸÑ ŸäÿπŸÖŸÑ "ÿ™ŸÅÿ¨Ÿäÿ±" ŸàŸÇÿ™ ÿ∏ŸáŸàÿ±Ÿáÿü
  const SEQ = [
    { text: "WAIT FOR IT...",                 ms: 1700, boom: false },
    { text: "üî• BOOM üî•",                      ms: 900,  boom: true  },
    { text: "HAPPY 17TH BIRTHDAY",            ms: 1900, boom: true  },
    { text: "MAZEN",                          ms: 2200, boom: false, big: true },
    { text: "17 YEARS OF ENERGY ‚ö°",          ms: 1400, boom: true  },
    { text: "DREAMS üöÄ  LOUD LAUGHS üòé",       ms: 1500, boom: false },
    { text: "YOU'RE NOT JUST GETTING OLDER",  ms: 1500, boom: false },
    { text: "YOU'RE GETTING STRONGER",        ms: 1500, boom: true  },
    { text: "THIS YEAR?",                     ms: 900,  boom: false },
    { text: "BIGGER MOVES  HIGHER GOALS",     ms: 1500, boom: true  },
    { text: "NO LIMITS",                      ms: 1400, boom: true  },
    { text: "STAY CRAZY  STAY REAL  STAY YOU",ms: 1700, boom: false },
    { text: "THE LEGEND STARTS NOW üí•",       ms: 2400, boom: true, big: true },
  ];

  const PIXEL = 6;         // ÿ≠ÿ¨ŸÖ ÿßŸÑÿ®ŸäŸÉÿ≥ŸÑÿ≤ (ŸÉÿ®ÿ±Ÿá ŸÑŸà ÿπÿßŸäÿ≤ ÿ®ŸäŸÉÿ≥ŸÑÿ© ÿ£ŸÇŸàŸâ: 8 ÿ£Ÿà 10)
  const FADE_IN = 0.08;    // ÿ≥ÿ±ÿπÿ© ÿ∏ŸáŸàÿ± ÿßŸÑÿ®ŸäŸÉÿ≥ŸÑÿ≤
  const FADE_OUT = 0.09;   // ÿ≥ÿ±ÿπÿ© ÿßÿÆÿ™ŸÅÿßÿ° ÿßŸÑÿ®ŸäŸÉÿ≥ŸÑÿ≤

  // ===== STATE =====
  let W,H,cols,rows,dpr;
  let target=[], intensity=[], jitterX=[], jitterY=[];
  let startTime = performance.now();

  // fireworks
  const rockets = [];
  const sparks = [];
  const confetti = [];

  const rand = (a,b)=>a+Math.random()*(b-a);

  // ===== Timeline helpers =====
  function totalDuration(){
    return SEQ.reduce((s,x)=>s+x.ms,0);
  }

  function currentSlide(now){
    const t = now - startTime;
    let acc = 0;
    for(let i=0;i<SEQ.length;i++){
      const a0 = acc;
      const a1 = acc + SEQ[i].ms;
      if(t >= a0 && t < a1){
        const local = (t - a0) / SEQ[i].ms; // 0..1
        return { idx:i, local, slide:SEQ[i] };
      }
      acc = a1;
    }
    // loop
    return { idx:-1, local:0, slide:null };
  }

  // ===== Canvas + text target =====
  function resize(){
    dpr = Math.max(1, Math.min(2, devicePixelRatio||1));
    W = innerWidth|0;
    H = innerHeight|0;
    canvas.width = (W*dpr)|0;
    canvas.height = (H*dpr)|0;
    canvas.style.width = W+"px";
    canvas.style.height = H+"px";
    ctx.setTransform(dpr,0,0,dpr,0,0);

    cols = Math.floor(W/PIXEL);
    rows = Math.floor(H/PIXEL);

    target = new Array(cols*rows).fill(0);
    intensity = new Array(cols*rows).fill(0);
    jitterX = new Array(cols*rows).fill(0).map(()=> (Math.random()-0.5)*0.8);
    jitterY = new Array(cols*rows).fill(0).map(()=> (Math.random()-0.5)*0.8);

    buildTextTarget(" ");
  }

  function buildTextTarget(text, isBig=false){
    const off = document.createElement("canvas");
    off.width = cols; off.height = rows;
    const o = off.getContext("2d");

    o.clearRect(0,0,cols,rows);
    o.fillStyle="#000";
    o.fillRect(0,0,cols,rows);

    // font size responsive
    const base = Math.min(cols, rows);
    const fontSize = Math.floor(base * (isBig ? 0.28 : 0.20));
    o.font = `900 ${fontSize}px system-ui, Arial`;
    o.textAlign="center";
    o.textBaseline="middle";
    o.fillStyle="#fff";

    // Split long text a bit if needed (simple wrap)
    const maxChars = Math.floor(cols * 0.9);
    const words = text.split(" ");
    const lines = [];
    let line = "";
    for(const w of words){
      const next = (line ? line + " " : "") + w;
      if(next.length > Math.max(14, Math.floor(maxChars/10)) && line){
        lines.push(line);
        line = w;
      } else line = next;
    }
    if(line) lines.push(line);

    const gap = Math.floor(fontSize*0.95);
    const startY = Math.floor(rows/2) - Math.floor((lines.length-1)*gap/2);

    lines.forEach((ln,i)=>{
      o.fillText(ln, Math.floor(cols/2), startY + i*gap);
    });

    const data = o.getImageData(0,0,cols,rows).data;
    for(let y=0;y<rows;y++){
      for(let x=0;x<cols;x++){
        const idx = y*cols+x;
        const a = data[idx*4+3];
        target[idx] = a>20 ? 1 : 0;
      }
    }
  }

  // ===== FIREWORKS =====
  function launchRocket(x){
    rockets.push({
      x, y:H+20,
      vx: rand(-0.7,0.7),
      vy: rand(-10.5,-13.5),
      life: rand(40,70),
      trail: []
    });
  }

  function explode(x,y,forceBig=false){
    const n = Math.floor(forceBig ? rand(130,190) : rand(80,130));
    for(let i=0;i<n;i++){
      const a = rand(0, Math.PI*2);
      const sp = rand(1.7, forceBig ? 6.2 : 5.2);
      const life = rand(forceBig ? 55 : 35, forceBig ? 95 : 70);
      sparks.push({
        x,y,
        vx: Math.cos(a)*sp,
        vy: Math.sin(a)*sp,
        g: 0.12,
        life,
        maxLife: life
      });
    }

    const c = Math.floor(forceBig ? rand(70,110) : rand(40,70));
    for(let i=0;i<c;i++){
      const life = rand(forceBig ? 110 : 80, forceBig ? 190 : 140);
      confetti.push({
        x,y,
        vx: rand(-3.5,3.5),
        vy: rand(-5, forceBig ? -11 : -9),
        rot: rand(0,Math.PI*2),
        vr: rand(-0.22,0.22),
        size: rand(3,8),
        life,
        maxLife: life
      });
    }
  }

  function updateFireworks(){
    for(let i=rockets.length-1;i>=0;i--){
      const r = rockets[i];
      r.x += r.vx; r.y += r.vy;
      r.vy += 0.10;
      r.life--;

      r.trail.push({x:r.x,y:r.y});
      if(r.trail.length>18) r.trail.shift();

      if(r.life<=0 || r.vy>0){
        explode(r.x,r.y,false);
        rockets.splice(i,1);
      }
    }

    for(let i=sparks.length-1;i>=0;i--){
      const s = sparks[i];
      s.x += s.vx; s.y += s.vy;
      s.vx *= 0.985; s.vy *= 0.985;
      s.vy += s.g;
      s.life--;
      if(s.life<=0) sparks.splice(i,1);
    }

    for(let i=confetti.length-1;i>=0;i--){
      const c = confetti[i];
      c.x += c.vx; c.y += c.vy;
      c.vy += 0.18;
      c.vx *= 0.99;
      c.rot += c.vr;
      c.life--;
      if(c.life<=0 || c.y>H+60) confetti.splice(i,1);
    }
  }

  function drawFireworks(){
    // rocket trails
    for(const r of rockets){
      ctx.beginPath();
      for(let i=0;i<r.trail.length;i++){
        const p = r.trail[i];
        if(i===0) ctx.moveTo(p.x,p.y);
        else ctx.lineTo(p.x,p.y);
      }
      ctx.lineWidth = 2;
      ctx.strokeStyle = "rgba(255,255,255,0.25)";
      ctx.stroke();

      ctx.beginPath();
      ctx.arc(r.x,r.y,3.2,0,Math.PI*2);
      ctx.fillStyle = "rgba(255,255,255,0.9)";
      ctx.fill();
    }

    // sparks
    for(const s of sparks){
      const t = s.life / s.maxLife;
      const a = Math.max(0, Math.min(1, t));
      ctx.beginPath();
      ctx.arc(s.x,s.y,1.7,0,Math.PI*2);
      ctx.fillStyle = `rgba(${Math.floor(120+140*(1-a))},${Math.floor(110+90*a)},${Math.floor(220)},${0.12+0.88*a})`;
      ctx.fill();
    }

    // confetti
    for(const c of confetti){
      const a = c.life / c.maxLife;
      ctx.save();
      ctx.translate(c.x,c.y);
      ctx.rotate(c.rot);
      ctx.globalAlpha = Math.max(0, Math.min(1, a));
      ctx.fillStyle = `rgba(${Math.floor(rand(120,255))},${Math.floor(rand(80,255))},${Math.floor(rand(120,255))},1)`;
      ctx.fillRect(-c.size/2,-c.size/2,c.size,c.size*0.65);
      ctx.restore();
      ctx.globalAlpha = 1;
    }
  }

  // ===== Pixel text draw =====
  let lastIdx = -999;

  function drawPixelText(now){
    const slideInfo = currentSlide(now);

    // loop when finished
    if(slideInfo.idx === -1){
      startTime = performance.now();
      lastIdx = -999;
      return;
    }

    const { idx, local, slide } = slideInfo;

    // when slide changes -> rebuild target + do boom if needed
    if(idx !== lastIdx){
      lastIdx = idx;
      buildTextTarget(slide.text, !!slide.big);

      if(slide.boom){
        // ÿßŸÜŸÅÿ¨ÿßÿ± ŸÇŸàŸä + ÿµŸàÿßÿ±ŸäÿÆ
        for(let i=0;i<4;i++) launchRocket(rand(W*0.2, W*0.8));
        explode(rand(W*0.25, W*0.75), rand(H*0.18, H*0.55), !!slide.big);
      }
    }

    // text visibility curve: Ÿäÿ∏Ÿáÿ± ŸÅŸä ÿ£ŸàŸÑ 60% ŸàŸäÿ®ÿØÿ£ ŸäÿÆÿ™ŸÅŸä ŸÅŸä ÿ¢ÿÆÿ± 25%
    const inEnd = 0.62;
    const outStart = 0.78;
    let want = 1;

    if(local < inEnd) want = 1;          // show
    else if(local > outStart) want = 0;  // hide
    else want = 1;                        // hold

    // pulse on big slides for extra drama
    const pulse = slide.big ? (0.75 + 0.25*Math.sin(now*0.006)) : 1;

    for(let y=0;y<rows;y++){
      for(let x=0;x<cols;x++){
        const i = y*cols + x;

        // tiny stars
        if(Math.random()<0.0016){
          ctx.fillStyle="rgba(255,255,255,0.03)";
          ctx.fillRect(x*PIXEL,y*PIXEL,1,1);
        }

        const isTarget = target[i] ? 1 : 0;
        const desired = isTarget * want;

        // approach desired
        if(desired > intensity[i]){
          intensity[i] = Math.min(1, intensity[i] + FADE_IN*(0.6+Math.random()*0.9));
        } else {
          intensity[i] = Math.max(0, intensity[i] - FADE_OUT*(0.6+Math.random()*0.6));
        }

        // drift
        jitterX[i] += (Math.random()-0.5)*0.05;
        jitterY[i] += (Math.random()-0.5)*0.05;
        jitterX[i] *= 0.99;
        jitterY[i] *= 0.99;

        const t = intensity[i];
        if(t > 0.02){
          const r = Math.floor(70 + 150*t);
          const g = Math.floor(110 + 80*t);
          const b = Math.floor(210 + 45*t);

          // glow
          ctx.fillStyle = `rgba(${r},${g},${b},${(0.06+0.16*t)*pulse})`;
          ctx.fillRect(x*PIXEL-1, y*PIXEL-1, PIXEL+2, PIXEL+2);

          // core
          ctx.fillStyle = `rgba(${r+25},${g+25},${b+25},${(0.25+0.75*t)*pulse})`;
          ctx.fillRect(
            x*PIXEL + jitterX[i],
            y*PIXEL + jitterY[i],
            PIXEL-1,
            PIXEL-1
          );
        }
      }
    }
  }

  // ===== MAIN LOOP =====
  function frame(now){
    ctx.fillStyle = "#05060a";
    ctx.fillRect(0,0,W,H);

    // subtle random fireworks in background
    if(Math.random() < 0.018) launchRocket(rand(W*0.15, W*0.85));
    if(Math.random() < 0.006) explode(rand(W*0.2, W*0.8), rand(H*0.18, H*0.55), false);

    updateFireworks();
    drawPixelText(now);
    drawFireworks();

    requestAnimationFrame(frame);
  }

  function replay(){
    startTime = performance.now();
    intensity.fill(0);
    rockets.length = 0;
    sparks.length = 0;
    confetti.length = 0;
    lastIdx = -999;

    // intro kick
    for(let i=0;i<7;i++) launchRocket(rand(W*0.2,W*0.8));
    for(let i=0;i<5;i++) explode(rand(W*0.2,W*0.8), rand(H*0.2,H*0.55), true);
  }

  // interactions
  addEventListener("resize", resize);
  document.getElementById("replay").addEventListener("click", replay);

  addEventListener("pointerdown", (e)=>{
    const x = e.clientX, y = e.clientY;
    launchRocket(x);
    explode(x, y, true);
  });

  // init
  resize();
  replay();
  requestAnimationFrame(frame);
})();
</script>
</body>
</html>

