<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Birthday Surprise</title>
  <style>
    :root{
      --bg:#070812;
      --fg:#e9eefc;
      --muted:rgba(233,238,252,.72);
      --dim:rgba(233,238,252,.18);
      --accent:#7c8cff;
    }
    html,body{height:100%;margin:0;background:var(--bg);overflow:hidden}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}

    .bg{
      position:fixed;inset:0;
      background:
        radial-gradient(1200px 900px at 20% 20%, rgba(124,140,255,.14), transparent 60%),
        radial-gradient(1000px 700px at 80% 70%, rgba(124,140,255,.10), transparent 60%),
        linear-gradient(180deg, rgba(255,255,255,.03), transparent 20%, transparent 80%, rgba(255,255,255,.02));
      filter:saturate(1.05);
    }
    .grain{
      position:fixed;inset:-20%;
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='220' height='220' filter='url(%23n)' opacity='.08'/%3E%3C/svg%3E");
      opacity:.16; mix-blend-mode:overlay;
      animation:drift 10s linear infinite;
      pointer-events:none;
    }
    @keyframes drift{to{transform:translate3d(-6%,-4%,0)}}

    .wrap{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;padding:24px}
    .card{width:min(920px,92vw);text-align:center}

    .topline{
      display:flex;align-items:center;justify-content:center;gap:10px;
      color:var(--muted);letter-spacing:.32em;text-transform:uppercase;
      font-size:12px;margin-bottom:18px;opacity:.95;
    }
    .dot{width:5px;height:5px;border-radius:50%;background:var(--accent);box-shadow:0 0 18px rgba(124,140,255,.7)}
    .big{
      color:var(--fg);font-weight:900;letter-spacing:-0.04em;line-height:1.02;
      font-size:clamp(34px,6vw,72px);margin:0;
      text-shadow:0 10px 40px rgba(0,0,0,.55);
    }
    .mid{
      color:var(--muted);font-weight:700;letter-spacing:-0.02em;
      font-size:clamp(16px,2.6vw,22px);margin:14px 0 0;
    }
    .sub{
      margin-top:18px;color:var(--dim);font-size:14px;
      letter-spacing:.08em;text-transform:uppercase;
    }
    .count{
      font-variant-numeric:tabular-nums;
      letter-spacing:-0.02em;
      font-size:clamp(72px,14vw,160px);
      font-weight:950;color:var(--fg);
      text-shadow:0 18px 60px rgba(124,140,255,.18), 0 10px 40px rgba(0,0,0,.6);
    }

    .fadeInUp{animation:fadeInUp .65s cubic-bezier(.2,.8,.2,1) both}
    @keyframes fadeInUp{
      from{opacity:0;transform:translate3d(0,14px,0) scale(.985)}
      to{opacity:1;transform:translate3d(0,0,0) scale(1)}
    }
    .fadeOut{animation:fadeOut .45s ease both}
    @keyframes fadeOut{to{opacity:0;transform:translate3d(0,-10px,0) scale(.99)}}

    .pulseAccent{display:inline-block;position:relative}
    .pulseAccent::after{
      content:"";position:absolute;left:50%;top:50%;
      width:10px;height:10px;border-radius:999px;
      transform:translate(-50%,-50%);
      background:rgba(124,140,255,.55);
      filter:blur(8px);opacity:.7;
      animation:pulse 1.6s ease-in-out infinite;
    }
    @keyframes pulse{
      0%,100%{transform:translate(-50%,-50%) scale(1);opacity:.45}
      50%{transform:translate(-50%,-50%) scale(1.55);opacity:.75}
    }

    .hint{
      position:fixed;left:50%;bottom:16px;transform:translateX(-50%);
      padding:10px 12px;border-radius:999px;
      background:rgba(0,0,0,.18);border:1px solid rgba(255,255,255,.08);
      color:var(--dim);font-size:13px;letter-spacing:.06em;text-transform:uppercase;
      backdrop-filter:blur(10px);
      user-select:none;
    }

    @media (prefers-reduced-motion: reduce){
      .grain,.fadeInUp,.fadeOut,.pulseAccent::after{animation:none !important}
    }
  </style>
</head>
<body>
  <div class="bg"></div>
  <div class="grain"></div>

  <div class="wrap">
    <div class="card" id="stage"></div>
  </div>

  <div class="hint" id="hint">tap to skip ▸</div>

<script>
(() => {
  const stage = document.getElementById("stage");
  const hint  = document.getElementById("hint");

  const NAME = "MAZEN";

  // Auto: intro + countdown + silence
  // Manual: everything after silence
  const scenes = [
    { type:"text",    ms:1600, top:"PRIVATE LINK", big:"WAIT.", mid:"Don’t blink." },
    { type:"text",    ms:1900, top:"NOT A NORMAL BIRTHDAY", big:"THIS IS NOT A NORMAL BIRTHDAY.", mid:"Keep watching." },

    { type:"count",   ms:1200, value:"3" },
    { type:"count",   ms:1200, value:"2" },
    { type:"count",   ms:1200, value:"1" },

    { type:"silence", ms:900 },

    // Manual from here:
    { type:"text",    top:"TODAY",     big:`${NAME}`, mid:"TURNS 17." },
    { type:"text",    top:"LEVEL UP",  big:"NO NOISE.", mid:"NO FILTERS." },
    { type:"text",    top:"JUST",      big:"POWER.", mid:"Built different." },
    { type:"text",    top:"THIS YEAR", big:"BIGGER MOVES.", mid:"Higher goals." },
    { type:"text",    top:"MODE",      big:"NO LIMITS.", mid:"No excuses." },
    { type:"text",    top:"FINAL",     big:"THE STORY STARTS NOW.", mid:"Happy 17th Birthday." },
  ];

  const manualStartIndex = scenes.findIndex(s => s.type === "silence") + 1;

  let idx = 0;
  let timer = null;

  // ✅ يمنع الضغط يعمل Next مرتين/تلاتة
  let tapLocked = false;
  const TAP_COOLDOWN_MS = 320;

  function clearTimer(){
    if(timer){
      clearTimeout(timer);
      timer = null;
    }
  }

  function clearStage(animOut=false){
    if(!stage.firstChild) return;
    if(animOut){
      stage.firstChild.classList.add("fadeOut");
      setTimeout(()=>{ stage.innerHTML=""; }, 240);
    } else stage.innerHTML="";
  }

  function render(scene){
    clearStage(true);

    const wrap = document.createElement("div");
    wrap.className = "fadeInUp";

    if(scene.type === "silence"){
      wrap.innerHTML = `
        <div class="topline">
          <span class="pulseAccent"><span class="dot"></span></span>
        </div>
        <div class="sub">...</div>
      `;
    } else if(scene.type === "count"){
      wrap.innerHTML = `
        <div class="topline">
          <span class="dot"></span><span>COUNTDOWN</span><span class="dot"></span>
        </div>
        <div class="count">${scene.value}</div>
        <div class="sub">get ready</div>
      `;
    } else {
      wrap.innerHTML = `
        <div class="topline"><span class="dot"></span><span>${scene.top}</span><span class="dot"></span></div>
        <h1 class="big">${scene.big}</h1>
        ${scene.mid ? `<p class="mid">${scene.mid}</p>` : ``}
        <div class="sub">tap for next</div>
      `;
    }

    stage.appendChild(wrap);

    hint.textContent = (idx >= manualStartIndex) ? "tap for next ▸" : "tap to skip ▸";
  }

  function showCurrent(){
    // ✅ مهم: أول ما ندخل manual نضمن إنه مفيش تايمر خالص
    if(idx >= manualStartIndex) clearTimer();

    render(scenes[idx]);

    // Auto only before manual
    if(idx < manualStartIndex){
      clearTimer();
      timer = setTimeout(() => {
        idx++;
        if(idx >= scenes.length) idx = 0;
        showCurrent();
      }, scenes[idx].ms);
    }
  }

  function next(){
    clearTimer(); // ✅ يلغي أي قلب تلقائي قبل ما ننقل
    idx++;
    if(idx >= scenes.length){
      idx = 0; // replay تلقائي بعد النهاية
    }
    showCurrent();
  }

  function start(){
    clearTimer();
    idx = 0;
    stage.innerHTML = "";
    showCurrent();
  }

  // ✅ استخدم pointerup بدل pointerdown (أهدى على الموبايل)
  // + preventDefault عشان ما يحصلش click إضافي
  function onTap(e){
    e.preventDefault();

    if(tapLocked) return;
    tapLocked = true;
    setTimeout(()=> tapLocked = false, TAP_COOLDOWN_MS);

    next();
  }

  // passive:false عشان preventDefault يشتغل
  window.addEventListener("pointerup", onTap, { passive:false });

  // start
  start();
})();
</script>
</body>
</html>
